<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<meta name="google-site-verification" content="KROUWRe-zWaSqvao4BWmgbO70GZiy6pzlwuktRu9JEk" />
<meta name="description" content="Generate custom and dynamic QR codes with a logo for free. Use the Zepot QR code generator to create QR codes for text, links, and more. Scan and download your QR codes easily." />
<meta name="keywords" content="zepto qr code generator, zepto bag qr code generator, zepto dynamic qr code generator, generate dynamic qr, zepto qr code scan" />
<title>Zepot QR Generator</title>
<meta name="monetag" content="4de9ba02af98344c39ef7e44a27a6bac">
<style>
:root{
  --bg1:#1FA2FF; --bg2:#12D8FA; --bg3:#A6FFCB;
  --card-bg: rgba(255,255,255,0.12);
  --card-border: rgba(255,255,255,0.2);
  --white: #ffffff;
  --muted: rgba(255,255,255,0.85);
  --accent1:#6a11cb; --accent2:#2575fc;
  --danger1:#dd2476; --danger2:#ff512f;
  --glass-blur: 10px;
}
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}
body{
  font-family: Inter, "Segoe UI", Roboto, system-ui, Arial;
  background: linear-gradient(135deg,var(--bg1),var(--bg2),var(--bg3));
  color:var(--white);
  min-height:100vh;
  display:flex;
  align-items:flex-start;
  justify-content:center;
  padding:18px;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}
.app{
  width:100%;
  max-width:720px;
}
.header{
  text-align:center;
  margin-bottom:14px;
}
.logo{
  width:64px;height:64px;margin:0 auto 8px;
  background:rgba(255,255,255,0.12);
  display:flex;align-items:center;justify-content:center;border-radius:12px;
  backdrop-filter: blur(6px);
  box-shadow:0 6px 18px rgba(0,0,0,0.18);
}
h1{font-size:clamp(18px,4vw,28px);margin-bottom:6px}
.subtitle{font-size:13px;opacity:0.95}
.controls{
  background:var(--card-bg);
  border:1px solid var(--card-border);
  border-radius:14px;
  padding:14px;
  backdrop-filter: blur(var(--glass-blur));
  box-shadow:0 10px 30px rgba(0,0,0,0.16);
  margin-bottom:18px;
}
textarea{
  width:100%;min-height:110px;padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.06);
  background: rgba(255,255,255,0.04); color:var(--muted); font-size:15px; resize:vertical;
  outline:none;
}
textarea::placeholder{color:rgba(255,255,255,0.7)}
.btn-row{
  display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-top:12px;
}
.btn{
  padding:10px 12px;border-radius:10px;border:none;font-weight:600;cursor:pointer;
  color:var(--white); font-size:14px;
  transition:transform .14s ease,box-shadow .14s ease;
  background-size:200% 100%;
}
.btn:active{transform:translateY(1px)}
.btn:disabled{opacity:0.5;cursor:not-allowed;transform:none}
.btn-gen{background-image:linear-gradient(90deg,var(--accent1),var(--accent2))}
.btn-paste{background-image:linear-gradient(90deg,#11998e,#38ef7d)}
.btn-download{background-image:linear-gradient(90deg,#f7971e,#ffd200)}
.btn-clear{background-image:linear-gradient(90deg,var(--danger1),var(--danger2))}

/* Style for the APK button */
@keyframes btn-glow {
  0% { box-shadow: 0 0 2px rgba(46, 204, 113, 0.6); }
  50% { box-shadow: 0 0 14px rgba(46, 204, 113, 1); }
  100% { box-shadow: 0 0 2px rgba(46, 204, 113, 0.6); }
}
.btn-apk {
  background-image: linear-gradient(90deg, #2ECC71, #27AE60);
  animation: btn-glow 2s infinite ease-in-out;
}

.preview-wrap{
  display:flex;flex-direction:column;align-items:center;gap:12px;
}
.qr-card{
  width:100%;max-width:420px;border-radius:14px;padding:18px;
  background:var(--card-bg);border:1px solid var(--card-border);
  display:flex;flex-direction:column;align-items:center;gap:12px;
  box-shadow:0 10px 30px rgba(0,0,0,0.16);
  backdrop-filter: blur(var(--glass-blur));
}
.qr-box{
  background:#fff;padding:10px;border-radius:8px;width:100%;display:flex;align-items:center;justify-content:center;
}
.qr-box img{width:320px;max-width:100%;height:auto;image-rendering:pixelated;border-radius:6px}
.qr-caption{font-size:13px;color:var(--muted);max-width:100%;text-align:center;word-break:break-word;padding:0 6px}
.nav-row{display:flex;gap:12px;align-items:center;justify-content:center;margin-top:6px}
.nav-btn{
  width:46px;height:46px;border-radius:50%;border:none;background:rgba(0,0,0,0.18);
  color:var(--white);display:flex;align-items:center;justify-content:center;cursor:pointer;
  box-shadow:0 6px 18px rgba(0,0,0,0.12);
}
.nav-btn:disabled{opacity:0.45;cursor:not-allowed}
.index-ind{padding:6px 10px;border-radius:999px;background:rgba(0,0,0,0.18);font-weight:600}

/* Suggestions styles */
.suggestions-container {
  width: 100%;
  margin-top: 8px;
  position: relative;
}

.suggestions-list {
  list-style: none;
  padding: 0;
  margin: 0;
  background: rgba(255,255,255,0.1);
  border-radius: 8px;
  border: 1px solid rgba(255,255,255,0.1);
  max-height: 200px;
  overflow-y: auto;
  backdrop-filter: blur(var(--glass-blur));
}

.suggestion-item {
  padding: 8px 12px;
  cursor: pointer;
  border-bottom: 1px solid rgba(255,255,255,0.05);
  transition: background 0.2s ease;
}

.suggestion-item:last-child {
  border-bottom: none;
}

.suggestion-item:hover {
  background: rgba(255,255,255,0.15);
}

.suggestion-highlight {
  font-weight: bold;
  color: white;
}

@media (max-width:480px){ /* Adjusted breakpoint for better wrapping */
  .btn-row{grid-template-columns:repeat(2,1fr)}
  .nav-row{gap:10px}
  .qr-box img{width:260px}
}
.fade-in{animation:fadeIn .28s ease both}
@keyframes fadeIn{from{opacity:0;transform:scale(.97)}to{opacity:1;transform:scale(1)}}
.notif{
  position:fixed;left:50%;transform:translateX(-50%);top:18px;background:rgba(0,0,0,0.6);
  color:#fff;padding:10px 14px;border-radius:8px;z-index:9999;font-weight:600;
}
</style>
</head>
<body>
  <div class="app" role="application" aria-labelledby="appTitle">
    <header class="header">
      <div class="logo" aria-hidden="true">
        <img src="https://i.postimg.cc/PJ4gg9fx/Zepto-id-Hv-TFe5-Uh-0.jpg" alt="Zepot Logo" style="width:48px; height:48px; border-radius:10px;">
      </div>
      <h1 id="appTitle">Zepot QR Generator</h1>
      <div class="subtitle">Generate custom QR codes with a logo from your text.</div>
    </header>

    <section class="controls" aria-label="Controls">
      <textarea id="input" placeholder="Paste or type text here (each line becomes one QR)"></textarea>
      
      <!-- Suggestions container -->
      <div class="suggestions-container" id="suggestionsContainer" style="display: none;">
        <ul class="suggestions-list" id="suggestionsList"></ul>
      </div>
      
      <!-- Button layout with APK button in the top row -->
      <div class="btn-row" style="margin-top:10px;">
        <button id="gen" class="btn btn-gen" aria-label="Generate QR from textarea">Generate</button>
        <button id="paste" class="btn btn-paste" aria-label="Paste from clipboard and generate">Paste & Gen</button>
        <button id="download" class="btn btn-download" aria-label="Download current QR" disabled>Download QR</button>
        <button class="btn btn-apk" onclick="window.location.href='https://github.com/parallelcc/MiCTS/releases/download/v2.4/MiCTS_2.4.apk'" aria-label="Download APK">APK Download</button>
      </div>

      <!-- Full-width Clear All button -->
      <div style="margin-top: 12px;">
        <button id="clear" class="btn btn-clear" style="width:100%; padding: 14px 12px; font-size: 16px;" aria-label="Clear all generated QRs" disabled>
          Clear All
        </button>
      </div>
    </section>

    <main>
      <div class="preview-wrap" aria-live="polite">
        <div id="emptyHint" class="qr-card" style="text-align:center">
          <div style="font-weight:700">No QR yet</div>
          <div style="font-size:13px;color:rgba(255,255,255,0.85);margin-top:6px">Paste text and press Generate or allow clipboard on load.</div>
        </div>

        <div id="previewArea" class="qr-card hidden" style="display:none" aria-hidden="true">
          <div class="qr-box" id="qrBox">
            <img id="qrImg" src="" alt="QR code preview">
          </div>
          <div id="caption" class="qr-caption" aria-live="polite"></div>
          <div class="nav-row" style="margin-top:6px;">
            <button id="prev" class="nav-btn" aria-label="Previous QR">&larr;</button>
            <div class="index-ind" id="indexInd">0 / 0</div>
            <button id="next" class="nav-btn" aria-label="Next QR">&rarr;</button>
          </div>
        </div>
      </div>
    </main>
  </div>

<!-- Add Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"></script>

<script>
(function(){
  const API_BASE = 'https://generator.qrcode.studio/qr/custom';
  const LOGO_URL = 'https://i.postimg.cc/xCf6bCys/Zepto.png';

  // SECURITY NOTE: This configuration is visible on the client-side, which is standard for Firebase.
  // However, it is CRITICAL to secure your database by setting up proper Firestore Security Rules
  // in the Firebase console to prevent unauthorized access.
  const firebaseConfig = {
    apiKey: "AIzaSyAME1PXnAbC_qcWxvsUQkrGcMZ9U-PQKPw",
    authDomain: "zepto-qr.firebaseapp.com",
    databaseURL: "https://zepto-qr-default-rtdb.firebaseio.com",
    projectId: "zepto-qr",
    storageBucket: "zepto-qr.firebasestorage.app",
    messagingSenderId: "778097504076",
    appId: "1:778097504076:web:c889233cebab20186369e9",
    measurementId: "G-RM39Q00JZ2"
  };
  
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const input = document.getElementById('input');
  const genBtn = document.getElementById('gen');
  const pasteBtn = document.getElementById('paste');
  const downloadBtn = document.getElementById('download');
  const clearBtn = document.getElementById('clear');
  const previewArea = document.getElementById('previewArea');
  const emptyHint = document.getElementById('emptyHint');
  const qrImg = document.getElementById('qrImg');
  const caption = document.getElementById('caption');
  const prevBtn = document.getElementById('prev');
  const nextBtn = document.getElementById('next');
  const indexInd = document.getElementById('indexInd');
  const suggestionsContainer = document.getElementById('suggestionsContainer');
  const suggestionsList = document.getElementById('suggestionsList');

  let store = [];
  let idx = 0;
  let touchStartX = 0, touchEndX = 0;
  let debounceTimer;
  let lastInputValue = '';

  function showNotif(msg, timeout=2200){
    const n = document.createElement('div'); n.className='notif'; n.textContent=msg;
    document.body.appendChild(n);
    setTimeout(()=>{ n.remove(); }, timeout);
  }

  function updateUI(){
    const has = store.length>0;
    downloadBtn.disabled = !has;
    clearBtn.disabled = !has;
    prevBtn.disabled = !has;
    nextBtn.disabled = !has;
    if(!has){
      previewArea.style.display='none';
      emptyHint.style.display='flex';
      previewArea.setAttribute('aria-hidden','true');
    } else {
      emptyHint.style.display='none';
      previewArea.style.display='flex';
      previewArea.classList.add('fade-in');
      previewArea.setAttribute('aria-hidden','false');
      showIndex();
    }
  }

  function showIndex(){
    indexInd.textContent = `${idx+1} / ${store.length}`;
  }
  
  function buildQrUrl(text, size = 400, format = 'png') {
    const config = {
      "logo": LOGO_URL,
      "logoMode": "clean"
    };
    const data = encodeURIComponent(text);
    const configStr = encodeURIComponent(JSON.stringify(config));
    return `${API_BASE}?data=${data}&size=${size}&file=${format}&config=${configStr}`;
  }

  function showCurrent(){
    if(!store.length) return;
    const text = store[idx];
    const url = buildQrUrl(text, 400);
    qrImg.src = url;
    caption.textContent = text;
    qrImg.classList.remove('fade-in');
    void qrImg.offsetWidth;
    qrImg.classList.add('fade-in');
    showIndex();
  }

  // Get suggestions from Firestore based on input prefix
  async function getSuggestions(prefix) {
    if (!prefix || prefix.trim().length < 2) {
      hideSuggestions();
      return [];
    }
    
    try {
      const snapshot = await db.collection("userInputs")
        .orderBy("text")
        .startAt(prefix)
        .endAt(prefix + "\uf8ff")
        .limit(5)
        .get();
      
      return snapshot.docs.map(doc => doc.data().text);
    } catch (error) {
      console.error("Error getting suggestions:", error);
      return [];
    }
  }

  // Display suggestions
  function displaySuggestions(suggestions, prefix) {
    if (suggestions.length === 0 || !prefix) {
      hideSuggestions();
      return;
    }
    
    suggestionsList.innerHTML = '';
    
    suggestions.forEach(suggestion => {
      const li = document.createElement('li');
      li.className = 'suggestion-item';
      
      // Highlight the matching prefix
      const index = suggestion.toLowerCase().indexOf(prefix.toLowerCase());
      if (index >= 0) {
        const before = suggestion.substring(0, index);
        const match = suggestion.substring(index, index + prefix.length);
        const after = suggestion.substring(index + prefix.length);
        
        li.innerHTML = `
          ${before}<span class="suggestion-highlight">${match}</span>${after}
        `;
      } else {
        li.textContent = suggestion;
      }
      
      li.addEventListener('click', () => {
        input.value = suggestion;
        hideSuggestions();
        input.focus();
      });
      
      suggestionsList.appendChild(li);
    });
    
    suggestionsContainer.style.display = 'block';
  }

  // Hide suggestions
  function hideSuggestions() {
    suggestionsContainer.style.display = 'none';
  }

  // Handle input changes with debounce
  async function handleInputChange() {
    const currentValue = input.value.trim();
    
    // Don't process if the value hasn't changed
    if (currentValue === lastInputValue) return;
    
    lastInputValue = currentValue;
    
    clearTimeout(debounceTimer);
    
    if (currentValue.length >= 2) {
      debounceTimer = setTimeout(async () => {
        const suggestions = await getSuggestions(currentValue);
        displaySuggestions(suggestions, currentValue);
      }, 300);
    } else {
      hideSuggestions();
    }
  }

  // QR Generation Function
  async function generateFromText(text){
    try {
      // First process the text into lines
      const lines = text
        .split(/\r?\n/)
        .map(l => l.trim().replace(/\s+/g, '_'))
        .filter(l => l.length > 0); // Only keep non-empty lines
      
      if(lines.length === 0) { 
        showNotif('Please enter some text to generate QR codes'); 
        return; 
      }
      
      // Store the lines for QR generation
      store = lines;
      idx = 0;
      
      // Clear input and update UI
      input.value = '';
      updateUI();
      
      // Show first QR code
      showCurrent();
      
      // Save the first line to Firestore for the suggestion engine (non-blocking)
      if (lines[0].length >= 3) { // Only save meaningful inputs
        try {
          await db.collection("userInputs").add({
            text: lines[0].trim(),
            timestamp: firebase.firestore.FieldValue.serverTimestamp(),
            count: 1
          });
        } catch (error) {
          console.error("Error saving to Firestore:", error);
        }
      }
      
      showNotif(`Generated ${lines.length} QR code(s)`);
      hideSuggestions();
      
    } catch (error) {
      console.error("QR generation error:", error);
      showNotif('Error generating QR codes', 3000);
    }
  }

  async function pasteAndGen(){
    try{
      if(!navigator.clipboard) { showNotif('Clipboard API not available'); return; }
      const t = await navigator.clipboard.readText();
      if(t && t.trim()){
        await generateFromText(t);
      } else {
        showNotif('Clipboard empty');
      }
    } catch(err){
      console.error(err);
      showNotif('Could not read clipboard — grant permission or paste manually',3000);
    }
  }

  async function tryAutoClipboard(){
    try{
      if(navigator.permissions){
        try {
          const perm = await navigator.permissions.query({name:'clipboard-read'});
          if(perm.state === 'granted'){
            const t = await navigator.clipboard.readText();
            if(t && t.trim()){ await generateFromText(t); showNotif('Auto-generated from clipboard'); return; }
          }
        } catch(e){}
      }
      if(navigator.clipboard){
        const t = await navigator.clipboard.readText().catch(()=>null);
        if(t && t.trim()){ await generateFromText(t); showNotif('Auto-generated from clipboard'); }
      }
    } catch(e){}
  }

  function next(){ if(!store.length) return; idx = (idx+1)%store.length; showCurrent(); }
  function prev(){ if(!store.length) return; idx = (idx-1+store.length)%store.length; showCurrent(); }

  async function downloadCurrent(){
    if(!store.length) return;
    const text = store[idx];
    const url = buildQrUrl(text, 800, 'png');
    try{
      const res = await fetch(url);
      const blob = await res.blob();
      const link = document.createElement('a');
      const safe = text.substring(0,40).replace(/[^a-z0-9]/ig,'_') || 'qr';
      const filename = `qr_${(idx+1)}_${safe}.png`;
      link.href = URL.createObjectURL(blob);
      link.download = filename;
      document.body.appendChild(link);
      link.click();
      link.remove();
      URL.revokeObjectURL(link.href);
      showNotif('Download started');
    } catch(err){
      console.error(err);
      showNotif('Download failed — check connection',3000);
    }
  }

  function clearAll(){
    store = []; idx = 0;
    qrImg.src = '';
    caption.textContent = '';
    updateUI();
    showNotif('Cleared');
  }

  // Event listeners
  genBtn.addEventListener('click', async () => await generateFromText(input.value));
  pasteBtn.addEventListener('click', pasteAndGen);
  downloadBtn.addEventListener('click', downloadCurrent);
  clearBtn.addEventListener('click', clearAll);
  nextBtn.addEventListener('click', next);
  prevBtn.addEventListener('click', prev);
  
  // Input event listeners for suggestions
  input.addEventListener('input', handleInputChange);
  input.addEventListener('focus', handleInputChange);
  input.addEventListener('blur', () => {
    setTimeout(hideSuggestions, 200);
  });

  document.addEventListener('keydown', (e)=>{
    if(!store.length) return;
    if(e.key === 'ArrowRight') next();
    if(e.key === 'ArrowLeft') prev();
  });

  const touchArea = previewArea;
  touchArea.addEventListener('touchstart',(e)=>{ touchStartX = e.changedTouches[0].screenX; }, {passive:true});
  touchArea.addEventListener('touchend',(e)=>{ touchEndX = e.changedTouches[0].screenX; handleSwipe(); }, {passive:true});
  function handleSwipe(){
    if(!touchStartX || !touchEndX) return;
    if(touchEndX < touchStartX - 50) next();
    else if(touchEndX > touchStartX + 50) prev();
    touchStartX = touchEndX = 0;
  }

  // Click outside to hide suggestions
  document.addEventListener('click', (e) => {
    if (!suggestionsContainer.contains(e.target) && e.target !== input) {
      hideSuggestions();
    }
  });

  (async function init(){
    updateUI();
    await tryAutoClipboard();
  })();

})();
</script>
</body>
</html>
